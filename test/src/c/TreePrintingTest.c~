#include "CalcLangAstC.h"
#include <stdio.h>
#include <stdlib.h>
#include "TestUtils.h"

int makeTree(){
  SourcePos* pos = (SourcePos*)malloc(sizeof(SourcePos));
  pos->lineNumber = 0;
  pos->linePosition = 0;

  AstNode* left = (AstNode*)malloc(sizeof(AstNode));
  left->nodeType = 11;
  left->actualNodeData.integer.pos = pos;
  left->actualNodeData.integer.lexeme = "8908";

  AstNode* right = (AstNode*)malloc(sizeof(AstNode));
  right->nodeType = 11;
  right->actualNodeData.integer.pos = pos;
  right->actualNodeData.integer.lexeme = "193874";

  AstNode* add = (AstNode*)malloc(sizeof(AstNode));
  add->nodeType = 5;
  add->actualNodeData.addition.pos = pos;
  add->actualNodeData.addition.left = left;
  add->actualNodeData.addition.right = right;

  AstNode* assign = (AstNode*)malloc(sizeof(AstNode));
  assign->nodeType = 23;
  assign->actualNodeData.variable.pos = pos;
  assign->actualNodeData.variable.name = 'x';
  assign->actualNodeData.variable.expr = add;
  
  char* res = astToString(assign);
  char* res2 = "let x = 8908 + 193874";

  ASSERT_EQ_STR(res, res2, "Error they do not match!!!");

  return 0;
}

int main(){
  RUN_TEST(makeTree);
}
